{
    "contents" : "library(lme4)\nlibrary(nlme)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# read in data. set working dir to data folder\n\nsoil13 <- read.csv(\"../data/lachat2013.csv\")\nplants13 <- read.csv(\"../data/data2013.csv\")\n\n\n# for making clean figures\nsource(\"theme-opts.R\")\n\n\n# filtering plant data\nplants13 <- plants13 %>% filter(spp==\"Cs\"|spp==\"Pa\")\n\np2013 <- plants13 %>% group_by(site, rep, month, place, spp) %>%\n  select(totC,C13,totN,SLA,ug.gfw_pr)\n# don't need currently p2013$year <- \"2013\"\n\n# merging the soil data with the plant data\n# have a doubling of soil data as one data point for soil N but \n# possibly two points for species.\nallsoil <- merge(soil13, p2013, by=c(\"place\",\"month\",\"rep\",\"site\"))\nallsoil$soilN <- allsoil$ammonia.kg + allsoil$no3.no2.kg\nallsoil$ratio <- allsoil$ammonia.kg/allsoil$no3.no2.kg\nallsoil$cn <- allsoil$totC/allsoil$totN\n\n# here I have set up the mixed effects model with soilN nested in place\n# place is a random effect but soilN is fixed, but nested. I want to have \n# soil N nested with the random effect of place.\n\n# DWS: I think you mean that soil N may show an effect of site or rep or\n# smapleID. I thinkt he latter?. I'm not sure. I'm sure you don't mean it is\n# nested in \"place\". I don't udnerstand the column headings well enough. Wht\n# are place, rep, site, sample and sampleID? This is a lot of factors but they\n# seem to be duplicated. I don't think you want this. You have species as a\n# fixed effect so it is fine, no duplication.\n\n# using nlme. random intercept by \"place\"?\nn.lme <- lme(totN ~ soilN*month*spp, random = ~ 1 | place,\n             data=allsoil, na.action=na.omit)\nsummary(n.lme)\nanova(n.lme)\n\n# DWS: or, are you worried about finer scale random effects? You'll have less\n# power and I'm worried since so many sampleIDs are unreplicated. It looks like\n# sample id is all you need as it is what groups the two N values per species? But what do you think groups those? is there a fine scale \"plot\" variable\"\nn2.lme <- lme(totN ~ soilN + month + spp + soilN:month +\n               soilN:spp, random = ~ 1 | Sample.ID,\n             data=allsoil, na.action=na.omit)\nsummary(n2.lme)\nanova(n2.lme)\n\n\nggplot(allsoil, aes(soilN, totN, shape=spp, color=spp)) +\n  geom_point()+\n  facet_grid(month~.)+ \n  scale_color_manual(name=\"N species\",\n                     values = c(\"black\", \"gray50\"))+\n  geom_smooth(method=\"lm\", se=F)+themeopts\n\n# using lme4 package\nn.lmer <- lmer(totN ~ spp*month*soilN + (1 | place), data=allsoil,\n               na.action=na.omit)\nsummary(n.lmer)\nanova(n.lmer)\n\n# these match. but you don't get p values. Can us likelihoods. note warning.\n# SHould apply to lme run above as well. Not sure why you had these tesing\n# separate models.\n",
    "created" : 1447700105731.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3307939083",
    "id" : "D825662E",
    "lastKnownWriteTime" : 1447697957,
    "path" : "~/GitHub/Indiana201213/scripts/soilN-traits-analysis.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}