{
    "contents" : "library(ggplot2)\nlibrary(plyr)\nlibrary(nlme)\nlibrary(plantecophys)\n\naci<-read.csv(\"ACi.csv\")\nprotein<-read.csv(\"2ndRoundProteinWorkbook.csv\",strip.white=TRUE, \n                  stringsAsFactors = FALSE)\nnitrate<-read.csv(\"nitrateR.csv\",strip.white=TRUE,\n                  stringsAsFactors = FALSE)\nlicorTraits<-read.csv(\"licor_traits.csv\",strip.white=TRUE,\n                      stringsAsFactors = FALSE)\nleafN<-read.csv(\"leafN.csv\", strip.white=T, stringsAsFactors=F)\nNR<-read.csv(\"NRESA.csv\", strip.white=T, stringsAsFactors=F)\npnue<-read.csv(\"pnue.csv\", strip.white=T, stringsAsFactors=F)\nchl<-read.csv(\"chl.csv\")\n\n# Stats for protein, nitrate, sla\n\nlme.sla<-lme(sla~spp*trt*age,random=~1|rep, data=protein)\nsummary(lme.sla)\nanova(lme.sla)\nqplot(spp, sla, shape=trt, data=nitrate)\n\nggplot(protein, aes(trt, sla, shape=spp))+geom_point()\n\n#nitrate by area\nlme.nitrateA<-lme(mMol.area~spp*trt*age,random=~1|sample, data=nitrate)\nsummary(lme.nitrateA)\nanova(lme.nitrateA)\nqplot(spp, mMol.area, shape=trt, data=nitrate)\n\nlme.nitrateW<-lme(mMol.gfw~spp*trt*age,random=~1|sample, data=nitrate)\nsummary(lme.nitrateW)\nanova(lme.nitrateW)\nqplot(spp, mMol.gfw, shape=trt, data=protein)\nplot(protein$spp, protein$mMol.gfw, xlab=\"spp\")\n# protein\nprotein2<-na.omit(protein)\nlme.proA<-lme(ug.cm2~spp*trt*age,random=~1|rep, data=protein)\nsummary(lme.proA)\nanova(lme.proA)\nqplot()\n\n\nlme.proW<-lme(ug.gfw~spp*trt*age,random=~1|rep, data=protein)\nsummary(lme.proW)\nanova(lme.proW)\nqplot(spp, ug.gfw, shape=trt, data=protein)\n\n# get points from aci curves\nambP<-read.csv(\"ambP2.csv\")\nPmax<-read.csv(\"Pmax.csv\")\n\nambP.lme<-lme(photo~spp*trt*age, random=~1|rep, data=ambP)\nsummary(ambP.lme)\nanova(ambP.lme)\n\nPmax.lme<-lme(photo~spp*trt*age, random=~1|rep, data=Pmax)\nsummary(Pmax.lme)\nanova(Pmax.lme)\n\nambPMean<-ddply(ambP, .(spp, trt, age), summarize,\n                photo_sd=sd(photo), \n                cond_sd=sd(cond), \n                ci_sd=sd(ci), \n                photo=mean(photo), \n                cond=mean(cond), \n                ci=mean(ci)\n                )\n\nPmaxMean<-ddply(Pmax, .(spp, trt, age), summarize,\n                photo_sd=sd(photo), \n                cond_sd=sd(cond), \n                ci_sd=sd(ci), \n                photo=mean(photo), \n                cond=mean(cond), \n                ci=mean(ci)\n)\n\nwrite.csv(ambPMean, \"ambPMean.csv\")\nwrite.csv(PmaxMean, \"PmaxMean.csv\")\n\naci1<-ddply(aci, .(spp, trt, age, point), summarize, \n           photo_sd=sd(photo), \n           cond_sd=sd(cond), \n           ci_sd=sd(ci), \n           photo=mean(photo), \n           cond=mean(cond), \n           ci=mean(ci))\n\naci$trt<-as.factor(aci$trt)\n\nqplot(ci, photo, color=age, shape=trt, data=aci) +\n  facet_grid(.~spp) +  \n  geom_pointrange(aes(ymin=photo-photo_err, ymax=photo+photo_err), size=0.5) +\n  scale_color_manual(values = c( \"red\", \"black\")) +\n  themeopts\n\nprotein$SLA<-protein$Wet.Area/protein$Dry.Weight\n\nnitrate<-ddply(nitrate, .(spp, trt, age), summarize, weight_sd=sd(mMol.gfw), area_sd=sd(mMol.area), weight=mean(mMol.gfw), area=mean(mMol.area))\n\nprotein2<-ddply(protein, .(spp, trt,age), summarize, \n               weight_sd=sd(ug.gfw),\n               area_sd=sd(ug.cm2), \n               SLA_sd=sd(sla), \n               weight=mean(ug.gfw),\n               area=mean(ug.cm2), \n               SLA=mean(sla))\n\nwrite.csv(protein2, \"protein_table.csv\")\nwrite.csv(aci, \"aci_table.csv\")\nwrite.csv(nitrate, \"nitrate_table.csv\")\n\n#add err\n\naci$photo_err<-aci$photo_sd/5\naci$cond_err<-aci$cond_sd/5\naci$ci_err<-aci$ci_sd/5\n\n#box plots\n\npaPro<-subset(protein, spp==\"pa\")\npaNit<-subset(nitrate, spp==\"pa\")\nclPro<-subset(protein, spp==\"cl\")\nclNit<-subset(nitrate, spp==\"cl\")\ncsPro<-subset(protein, spp==\"cs\")\ncsNit<-subset(nitrate, spp==\"cs\")\n\nplot(paPro$trt, paPro$mMol.gfw, xlab=\"Nitrogen treatment\", ylab=\"nitrate in Pa\")\nplot(clPro$trt, clPro$mMol.gfw, xlab=\"Nitrogen treatment\", ylab=\"nitrate in Cl\")\nplot(csPro$trt, csPro$mMol.gfw, xlab=\"Nitrogen treatment\", ylab=\"nitrate in Cs\")\n\nplot(paPro$trt, paPro$ug.gfw, xlab=\"Nitrogen treatment\", ylab=\"sol protein in Pa\")\nplot(clPro$trt, clPro$ug.gfw, xlab=\"Nitrogen treatment\", ylab=\"sol protein in Cl\")\nplot(csPro$trt, csPro$ug.gfw, xlab=\"Nitrogen treatment\", ylab=\"sol protein in Cs\")\n\n\n\nvcmax.lme<-lme(vcmax~spp*trt*age, random=~1|sample, data=licorTraits)\nsummary(vcmax.lme)\nanova(vcmax.lme)\n\nce.lme<-lme(CE~spp*trt*age, random=~1|sample, data=licorTraits)\nsummary(ce.lme)\nanova(ce.lme)\n\njmax.lme<-lme(jmax~spp*trt*age, random=~1|sample, data=licorTraits)\nsummary(jmax.lme)\nanova(jmax.lme)\n\n# amb\n\namb<-subset(aci, point==\"7\")\namb.lme<-lme(photo~spp*trt*age, random=~1|sample, data=amb)\nsummary(amb.lme)\nanova(amb.lme)\n\nLicorTRT<-ddply(licorTraits, .(spp, trt,age), summarize,\n                vcmaxsd=sd(vcmax),\n                vcmax=mean(vcmax),\n                jmaxsd=sd(jmax),\n                jmax=mean(jmax),\n                rdsd=sd(rd),\n                rd=mean(rd))\nwrite.csv( LicorTRT,\"LicorTRT.csv\")\n\ncemean<-ddply(licorTraits, .(spp, trt,age), summarize,\n                cesd=sd(CE),\n                ce=mean(CE))\nwrite.csv(cemean,\"cemean.csv\")\n\nleafN$CN<-leafN$C/leafN$N\nleafN_mean<-ddply(leafN, .(spp, trt, age), summarize, \n           X13C_sd=sd(X13C), \n           C_sd=sd(C), \n           N_sd=sd(N),\n           CN_sd=sd(CN),\n           CN=mean(CN),\n           X13C=mean(X13C), \n           C=mean(C), \n           N=mean(N))\n\nwrite.csv(leafN_mean, \"leafN_mean2.csv\")\n\n\nCN.lme<-lme(CN~spp*trt*age, random=~1|sample, data=leafN)\nsummary(CN.lme)\nanova(CN.lme)\nX13C.lme<-lme(X13C~spp*trt*age, random=~1|sample, data=leafN)\nsummary(X13C.lme)\nanova(X13C.lme)\nC.lme<-lme(C~spp*trt*age, random=~1|sample, data=leafN)\nsummary(C.lme)\nanova(C.lme)\nN.lme<-lme(N~spp*trt*age, random=~1|sample, data=leafN)\nsummary(N.lme)\nanova(N.lme)\n\nNR=subset(NR, type!=\"root\")\nNR=na.omit(NR)\nNR_mean<-ddply(NR, .(spp, type, trt), summarize, \n               mgcl2_gfwsd=sd(mgcl2_gfw),\n               mgcl2_gfw=mean(mgcl2_gfw),\n               mgcl2_chlsd=sd(mgcl_chl),\n               mgcl2_chl=mean(mgcl_chl),\n               edta_gfwsd=sd(edta_gfw),\n               edta_gfw=mean(edta_gfw),\n               edta_chlsd=sd(edta_chl),\n               edta_chl=mean(edta_chl),\n               )\nlme.nr<-lme(edta_gfw~spp*trt*type,random=~1|Sample, data=NR)\nsummary(lme.nr)\nanova(lme.nr)\n\n# stats for pnue\n\nlme.pnue<-lme(PNUE~spp*trt*age,random=~1|rep, data=pnue)\nsummary(lme.pnue)\nanova(lme.pnue)\nqplot(spp, pnue, shape=trt, data=pnue)\n\npnue_mean<-ddply(pnue, .(spp, trt, age), summarize,\n                 pnue_sd=sd(PNUE),\n                 pnue=mean(PNUE))\n\nggplot(pnue, aes(spp, PNUE, color=trt)) + \n  facet_grid(.~age) +\n  geom_boxplot()\n\n# stats for chl\n\nchl.lme<-lme(chl~spp*trt*age, random=~1|rep, data=chl)\nsummary(chl.lme)\nanova(chl.lme)\n\nchlMean<-ddply(chl, .(spp, trt, age), summarize,\n               chl_sd=sd(chl),\n               chl=mean(chl))\n\n# vcmax figure\n\no<-c(\"pa\",\"cs\",\"cl\")\nt<-c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\")\norder2<-data.frame(spp=o,species=t)\n\nLicorTRT=merge(LicorTRT, order2)\n\n\nvcmax<-ggplot(LicorTRT, aes(species, vcmax, shape=trt, color= age)) +\n  geom_pointrange(aes(ymax=vcmax+vcmaxsd, ymin=vcmax-vcmaxsd),size=2,\n                  position = position_dodge (width=0.5)) +\n  labs(x=NULL) +\n  scale_y_continuous(expression(V[cmax] ~ ( mu * mol %.% m^{-2} %.% s^{-1} ) ) )  +\n  theme_bw() +\n  scale_shape_manual(values=c(16,17)) +\n  scale_color_manual(values = c( \"grey50\", \"black\")) +\n  scale_x_discrete(limits=c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\"))+\n  theme(axis.text.x  = element_text(face=\"italic\")) +\n  annotate(\"text\", label = \"A\", x = .6, y = 82.5, size = 12) +\n  themeopts \n\n\n\nJmax<-ggplot(LicorTRT, aes(species, jmax, shape=trt, color= age)) +\n  geom_pointrange(aes(ymax=jmax+jmaxsd, ymin=jmax-jmaxsd),size=2,\n                  position = position_dodge (width=0.5)) +\n  labs(x=NULL) +\n  scale_y_continuous(expression(J[max] ~ ( mu * mol %.% m^{-2} %.% s^{-1} ) ) )  +\n  theme_bw() +\n  scale_shape_manual(values=c(16,17)) +\n  scale_color_manual(values = c( \"grey50\", \"black\")) +\n  scale_x_discrete(limits=c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\"))+\n  theme(axis.text.x  = element_text(face=\"italic\")) +\n  annotate(\"text\", label = \"C\", x = .6, y = 150, size = 12) +  \n  themeopts \n\nLicorTRT=merge(LicorTRT, order2)\n\ncemean<-merge(cemean, order2)\nce<-ggplot(cemean, aes(species, ce, shape=trt, color= age)) +\n  geom_pointrange(aes(ymax=ce+cesd, ymin=ce-cesd),size=2,\n                  position = position_dodge (width=0.5)) +\n  labs(x=\"\") +\n  labs(y=expression(paste(italic(CE[ ]),\" (\", mu * mol %.% m^{-2} %.% s^{-1}, \")\")))  +\n  scale_y_continuous(expression(CE ~ ( mu * mol %.% m^{-2} %.% s^{-1} ) ) )  +\n    theme_bw() +\n  scale_shape_manual(values=c(16,17)) +\n  scale_color_manual(values = c( \"grey50\", \"black\")) +\n  scale_x_discrete(limits=c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\"))+\n  annotate(\"text\", label = \"B\", x = .6, y = .145, size = 12) +\n  theme(axis.text.x  = element_text(face=\"italic\")) +\n  themeopts \n\no<-c(\"Pa\",\"Cs\",\"Cl\")\nt<-c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\")\norder3<-data.frame(spp=o,species=t)\n\nchlmean2<-merge(chlMean, order3)\nchl<-ggplot(chlmean2, aes(species, chl, shape=trt, color= age)) +\n  geom_pointrange(aes(ymax=chl+chl_sd, ymin=chl-chl_sd),size=2,\n                  position = position_dodge (width=0.5)) +\n  labs(x=\"\") +\n  labs(y=expression(paste(italic(chlorophyll[ ]),\" (\", mu * g %.% gfw^{-1}, \")\")))  +\n  scale_y_continuous(expression(Chlorophyll ~ ( mu * g %.% gfw^{-1}) ) )  +\n  theme_bw() +\n  scale_shape_manual(values=c(16,17)) +\n  scale_color_manual(values = c( \"grey50\", \"black\")) +\n  scale_x_discrete(limits=c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\"))+\n  annotate(\"text\", label = \"D\", x = .6, y = 2.2, size = 12) +\n  theme(axis.text.x  = element_text(face=\"italic\")) +\n  themeopts \n\nmultiplot(vcmax, ce, Jmax, chl, cols=2)\n\n\n\n#percents \n\npercents<-subset(leafN, select=c(\"sample\", \"spp\",\"rep\",\"trt\",\"age\"))\n\no<-c(\"pa\",\"cs\",\"cl\")\nt<-c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\")\norder2<-data.frame(spp=o,species=t)\n\nprotein2=merge(protein2, order2)\n\n# protein figures\nggplot(protein2, aes(species, area, shape=trt, color= age)) +\n  geom_pointrange(aes(ymax=area+area_sd, ymin=area-area_sd),size=1.5,\n                  position = position_dodge (width=0.5)) +\n  labs(x=\"\") +\n  labs(y=expression(paste(\"Leaf Soluble Protein (\", mu *g %.% cm^{-2}, \")\")))+\n  theme_bw() +\n  scale_shape_manual(values=c(16,17)) +\n  scale_color_manual(values = c( \"grey50\", \"black\")) +\n  scale_x_discrete(limits=c(\"P. arundinacea\",\"C. stricta\",\"C. lacustris\"))+     \n  theme(axis.text.x  = element_text(face=\"italic\")) +\n  themeopts \n\nggsave(file=\"figure7.png\", dpi=300)\n",
    "created" : 1453140047232.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2505396807",
    "id" : "20764F6F",
    "lastKnownWriteTime" : 1411417232,
    "path" : "C:/Users/Lizz/Dropbox/Nitrate and Protein project/rcode.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_source"
}